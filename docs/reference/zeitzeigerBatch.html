<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Train and test a ZeitZeiger predictor, accounting for batch effects — zeitzeigerBatch • zeitzeiger</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Train and test a ZeitZeiger predictor, accounting for batch effects — zeitzeigerBatch" />
<meta property="og:description" content="zeitzeigerBatch trains and tests a predictor on multiple datasets
independently, using ComBat to correct for batch effects prior
to running zeitzeiger. This function requires the metapredict
package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zeitzeiger</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/zeitzeiger.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Introduction to ZeitZeiger</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/hugheylab/zeitzeiger/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Train and test a ZeitZeiger predictor, accounting for batch effects</h1>
    <small class="dont-index">Source: <a href='https://github.com/hugheylab/zeitzeiger/blob/master/R/zeitzeiger_predict.R'><code>R/zeitzeiger_predict.R</code></a></small>
    <div class="hidden name"><code>zeitzeigerBatch.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>zeitzeigerBatch</code> trains and tests a predictor on multiple datasets
independently, using <code><a href='https://rdrr.io/pkg/sva/man/ComBat.html'>ComBat</a></code> to correct for batch effects prior
to running <code>zeitzeiger</code>. This function requires the <code><a href='https://rdrr.io/pkg/metapredict/man/metapredict.html'>metapredict</a></code>
package.</p>
    </div>

    <pre class="usage"><span class='fu'>zeitzeigerBatch</span>(<span class='no'>ematList</span>, <span class='no'>trainStudyNames</span>, <span class='no'>sampleMetadata</span>, <span class='no'>studyColname</span>,
  <span class='no'>batchColname</span>, <span class='no'>timeColname</span>, <span class='kw'>nKnots</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nTime</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>useSpc</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>sumabsv</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>orth</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>nSpc</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>timeRange</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span> - <span class='fl'>0.01</span>,
  <span class='fl'>0.01</span>), <span class='kw'>covariateName</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>featuresExclude</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>dopar</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ematList</th>
      <td><p>Named list of matrices of measurements, one for each dataset,
some of which will be for training, others for testing. Each matrix should
have rownames corresponding to sample names and colnames corresponding to
feature names.</p></td>
    </tr>
    <tr>
      <th>trainStudyNames</th>
      <td><p>Character vector of names in <code>ematList</code> corresponding
to datasets for training.</p></td>
    </tr>
    <tr>
      <th>sampleMetadata</th>
      <td><p>data.frame containing relevant information for each sample
across all datasets. Must have a column named <code>sample</code>.</p></td>
    </tr>
    <tr>
      <th>studyColname</th>
      <td><p>Name of column in <code>sampleMetdata</code> that contains
information about which dataset each sample belongs to.</p></td>
    </tr>
    <tr>
      <th>batchColname</th>
      <td><p>Name of column in <code>sampleMetdata</code> that contains
information about which dataset each sample belongs to. This should correspond
to the names of <code>ematList</code>, and will often be the same as
<code>studyColname</code>, but doesn't have to be.</p></td>
    </tr>
    <tr>
      <th>timeColname</th>
      <td><p>Name of column in <code>sampleMetdata</code> that contains
the values of the periodic variable.</p></td>
    </tr>
    <tr>
      <th>nKnots</th>
      <td><p>Number of internal knots to use for the periodic smoothing spline.</p></td>
    </tr>
    <tr>
      <th>nTime</th>
      <td><p>Number of time-points by which to discretize the time-dependent
behavior of each feature. Corresponds to the number of rows in the matrix for
which the SPCs will be calculated.</p></td>
    </tr>
    <tr>
      <th>useSpc</th>
      <td><p>Logical indicating whether to use <code>SPC</code> (default) or <code>svd</code>.</p></td>
    </tr>
    <tr>
      <th>sumabsv</th>
      <td><p>L1-constraint on the SPCs, passed to <code>SPC</code>.</p></td>
    </tr>
    <tr>
      <th>orth</th>
      <td><p>Logical indicating whether to require left singular vectors
be orthogonal to each other, passed to <code>SPC</code>.</p></td>
    </tr>
    <tr>
      <th>nSpc</th>
      <td><p>Vector of the number of SPCs to use for prediction. If <code>NA</code> (default),
<code>nSpc</code> will become <code>1:K</code>, where <code>K</code> is the number of SPCs in <code>spcResult</code>.
Each value in <code>nSpc</code> will correspond to one prediction for each test observation.
A value of 2 means that the prediction will be based on the first 2 SPCs.</p></td>
    </tr>
    <tr>
      <th>timeRange</th>
      <td><p>Vector of values of the periodic variable at which to calculate likelihood.
The time with the highest likelihood is used as the initial value for the
MLE optimizer.</p></td>
    </tr>
    <tr>
      <th>covariateName</th>
      <td><p>Name of column(s) in <code>sampleMetadata</code> containing
information about other covariates for <code>ComBat</code>, besides <code>batchColname</code>.
If <code>NA</code> (default), then there are no other covariates.</p></td>
    </tr>
    <tr>
      <th>featuresExclude</th>
      <td><p>Named list of character vectors corresponding to features
to exclude from being used for prediction for the respective test datasets.</p></td>
    </tr>
    <tr>
      <th>dopar</th>
      <td><p>Logical indicating whether to process the folds in parallel.
Use <code><a href='https://rdrr.io/pkg/doParallel/man/registerDoParallel.html'>registerDoParallel</a></code> to register the parallel backend.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>spcResultList</dt><dd><p>List of results from <code>zeitzeigerSpc</code>, one for each test dataset.</p></dd>
<dt>timeDepLike</dt><dd><p>3-D array of likelihood, with dimensions for each test observation
(across all datasets), each element of <code>nSpc</code>, and each element of <code>timeRange</code>.</p></dd>
<dt>mleFit</dt><dd><p>List (for each element in <code>nSpc</code>) of lists (for each test observation)
of <code>mle2</code> objects.</p></dd>
<dt>timePred</dt><dd><p>Matrix of predicted times for test observations by values of <code>nSpc</code>.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='zeitzeiger.html'>zeitzeiger</a></code>, <code><a href='https://rdrr.io/pkg/metapredict/man/metapredict.html'>metapredict</a></code>, <code><a href='https://rdrr.io/pkg/sva/man/ComBat.html'>ComBat</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jake Hughey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


